<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="edit.css">

    <style>
        .col-md-5,
        .col-md-12 {
            border: solid;
            /* 設定底部間隔，您可以調整這個值 */
        }
    </style>

</head>

<body>
    <script src="js/popper.min.js"></script>
    <script src="js/bootstrap.min.js"></script>


    <div class="top">
        <h1>校園美食指南</h1>
        <a href="#" onclick="openMenu()"><img src="left.png" alt=""></a>
    </div>
    <div class="bottom" id="bottom">
        <div class="menu" id="menu">
            <div class="menu-items">
                <ul class="nav-links">
                    <li><a href="#" onclick="clearAll() , showAll()">
                            <i><img src="request40.png" alt=""></i>
                            <span class="link-name">顯示全部店家</span>
                        </a></li>
                    <li><a href="#" onclick="showNTOU(),showNTOUcount()">
                            <i><img src="keyrecord40.png" alt=""></i>
                            <span class="link-name">可用海大卡的店家</span>
                        </a></li>
                    <li><a href="#" onclick="showCategory()">
                            <i><img src="keyrecord40.png" alt=""></i>
                            <span class="link-name">顯示店家總類</span>
                        </a></li>


                    <li><a href="#" onclick="clearAll() , showAddItem()">
                            <i><img src="request40.png" alt=""></i>
                            <span class="link-name">新增店家</span>
                        </a></li>
                    <li><a href="#" onclick="clearAll() , showDeleteItem()">
                            <i><img src="keyrecord40.png" alt=""></i>
                            <span class="link-name">刪除店家</span>
                        </a></li>
                    <li><a href="#" onclick="clearAll() , showUpdateItem()">
                            <i><img src="keyrecord40.png" alt=""></i>
                            <span class="link-name">修改店家</span>
                        </a></li>


                    <li><a href="#" onclick="clearAll() ,showAddCategory()">
                            <i><img src="keyrecord40.png" alt=""></i>
                            <span class="link-name">新增店家種類</span>
                        </a></li>
                </ul>
            </div>
        </div>

        <div class="board">

            
            <div class="container">
                
                <p id="NumberOfNTOUCard" style="font-size: 30px;"></p>
                <div class="row">

                </div>
            </div>
            <div class="board-item">
                

                <!-- 新增資料 -->
                <div class="additem" id="additem">
                    <h1>新增資料</h1>
                    <div class="addContainer">

                        <form action="insert.php" method="POST">
                            <div class="title">
                                <p>餐廳名稱</p>
                                <p>餐廳網站</p>
                                <p>餐廳電話</p>
                                <p>餐廳地址</p>
                                <p>餐廳營業時間</p>
                            </div>
                            <hr>
                            <div class="text">
                                <p><input type="text" name="name"></p>
                                <p><input type="text" name="website"></p>
                                <p><input type="text" name="phone"></p>
                                <p><input type="text" name="address"></p>
                                <p><input type="text" name="business_hour"></p>
                            </div>
                            <input type="submit" name="submit" value="新增" class="go">
                        </form>
                    </div>

                </div>

                <!-- 刪除項目 -->
                <div class="deleteitem" id="deleteitem">
                    <h1>刪除餐廳</h1>
                    <form action="deleteRestaurant.php" method="POST">
                        <div class="deleteContainer">
                            <div class="title">
                                <!-- 標題 -->
                                <p>餐廳名稱</p>
                            </div>
                            <hr>
                            <div class="text">
                                <!-- 內容 -->
                                <p><input type="text" name="name" placeholder="八方雲集" required></p>
                            </div>
                        </div>
                        <button type="submit">確認刪除</button>
                    </form>
                </div>

                <!-- 修改項目 -->
                <div class="updateitem" id="updateitem">
                    <h1>修改餐廳營業時間</h1>
                    <form action="updateBusinessHour.php" method="POST">
                        <div class="updateContainer">
                            <div class="title">
                                <!-- 標題 -->
                                <p>餐廳名稱</p>
                                <p>餐廳營業時間</p>
                            </div>
                            <hr>
                            <div class="text">
                                <!-- 內容 -->
                                <p><input type="text" name="name" required></p>
                                <p><input type="text" name="business_hour" required></p>
                            </div>
                        </div>
                        <button type="submit">確認更改</button>
                    </form>

                </div>

               

                <!-- 新增種類-->
                <div class="addCatatory" id="addCatatory">
                    <div class="addCatatoryContainer">

                        <form action="insertCategory.php" method="POST">
                            <div class="title">
                                <p>餐廳名稱</p>
                                <p>餐廳種類</p>
                            </div>
                            <hr>
                            <div class="text">
                                <p><input type="text" name="name" required></p>
                                <p><input type="text" name="kinds" required></p>
                            </div>
                            <input type="submit" name="submit" value="新增" class="go">
                        </form>
                    </div>

                </div>
            </div>


        </div>
    </div>


    <script>


        function clearAll() {

        }

        function showAll() {
            clearAll();

            fetch('showAllRestaurant.php', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json', // 請根據你的後端需要設置正確的 Content-Type
                },
            })
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Network response was not ok');
                    }
                    return response.text();
                })
                .then(data => {
                    var total = data.split("+");
                    var count = total[0];
                    var items = total[1].split("\n");

                    var parentContainer = document.querySelector(".row");

                    for (var i = 0; i < count; i++) {
                        var temp = items[i].split("|");

                        var colDiv = document.createElement("div");
                        colDiv.className = "col-12 col-md-12 mt-5 me-auto ms-auto";

                        var restaurantDiv = document.createElement("div");
                        restaurantDiv.innerHTML = `
                <h1 class="Alltitle">${temp[0] || "null"}</h1>
                <div class="Allcontent">
                    <p class="text">餐廳電話${temp[2] || "null"}</p>
                    <p class="text">餐廳地址${temp[3] || "null"}</p>
                    <p class="text">餐廳營業時間${temp[4] || "null"}</p>
                    <button class="w-100 mb-2"> 
                        ${temp[1] !== " " ? `<a href="${temp[1] || "null"}" target="_blank">餐廳網站</a>` : "無連結"}

                    </button>
                </div>`;

                        colDiv.appendChild(restaurantDiv);
                        parentContainer.appendChild(colDiv);
                    }
                })
                .catch(error => {
                    console.error('There has been a problem with your fetch operation:', error);
                });
        }
        function showNTOU() {
            clearAll();

            fetch('showNCRestaurant.php', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json', // 請根據你的後端需要設置正確的 Content-Type
                },
            })
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Network response was not ok');
                    }
                    return response.text();
                })
                .then(data => {
                    var total = data.split("+");
                    var count = total[0];
                    var items = total[1].split("\n");
                    var parentContainer = document.querySelector(".row");

                    for (var i = 0; i < count; i++) {
                        var temp = items[i].split("|");

                        var colDiv = document.createElement("div");
                        colDiv.className = "col-12 col-md-12 mt-5 me-auto ms-auto";

                        var restaurantDiv = document.createElement("div");
                        restaurantDiv.innerHTML = `
                        <h1 class="Alltitle">${temp[0] || "null"}</h1>
                        <div class="Allcontent">
                            <p class="text">餐廳電話${temp[2] || "null"}</p>
                            <p class="text">餐廳地址>${temp[3] || "null"}</p>
                            <p class="text">餐廳營業時間${temp[4] || "null"}</p>
                            <button class="w-100 mb-2"> 
                                ${temp[1] !== " " ? `<a href="${temp[1] || "null"}" target="_blank">餐廳網站</a>` : "無連結"}
                            </button>
                        </div>`;

                        colDiv.appendChild(restaurantDiv);
                        parentContainer.appendChild(colDiv);
                    }
                })
                .catch(error => {
                    console.error('There has been a problem with your fetch operation:', error);
                });
        }
        function showNTOUcount() {
            fetch("countNTOUCard.php")
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Network response was not ok');
                    }
                    return response.text();
                })
                .then(data => {
                    var resultElement = document.getElementById("NumberOfNTOUCard");
                    resultElement.innerHTML = "能使用海大卡的店家個數: " + data;
                })
                .catch(error => {
                    console.error('There has been a problem with your fetch operation:', error);
                });
        }
        function showCategory() {
            clearAll();

            fetch('showAllRestaurantKind.php', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
            })
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Network response was not ok');
                    }
                    return response.text();
                })
                .then(data => {
                    var total = data.split("+");
                    var count = total[0];
                    var items = total[1].split("\n");
                    var parentContainer = document.querySelector(".row");

                    for (var i = 0; i < count; i++) {
                        var temp = items[i].split("|");

                        var colDiv = document.createElement("div");
                        colDiv.className = "col-12 col-md-12 mt-5 me-auto ms-auto";

                        var restaurantDiv = document.createElement("div");
                        restaurantDiv.innerHTML = `
                <h1 class="Alltitle">${temp[0] || "null"}</h1>
                <p class="text" style="display: inline-block;">餐廳總類&nbsp;</p><p style="display: inline-block;">${temp[1] || "null"}</p>`;

                        // 使用 for 迴圈，避免無窮迴圈
                        for (var j = i + 1; j < count; j++) {
                            var next = items[j].split("|");
                            if (next[0] == temp[0] && next[0] != " ") {
                                // 使用 inline-block，確保不換行
                                restaurantDiv.innerHTML += `<p class="text"  style="display: inline-block;"></p><p style="display: inline-block;">${next[1] || "null"},</p>`;
                                i = j; // 更新 i 到最後一個相同類別的項目，以避免重複處理
                            } else {
                                break;
                            }
                        }

                        restaurantDiv.innerHTML += `

                    <p class="text">餐廳地址${temp[2] || "null"}</p>`;

                        colDiv.appendChild(restaurantDiv);
                        parentContainer.appendChild(colDiv);
                    }
                })
                .catch(error => {
                    console.error('There has been a problem with your fetch operation:', error);
                });
        }



        // ---------------------------------------------------------------------------------------------

        let additem = document.getElementById("additem");
        let deleteitem = document.getElementById("deleteitem");
        let updateitem = document.getElementById("updateitem");
        let addCatatory = document.getElementById("addCatatory");

        let bottom = document.getElementById("bottom");
        function openMenu() {
            bottom.classList.toggle("show");
        }

        function clearAll() {
            var parentContainer = document.querySelector(".row");
            parentContainer.innerHTML = '';

            var resultElement = document.getElementById("NumberOfNTOUCard");
            resultElement.innerHTML = '';

            additem.classList.remove("show");
            deleteitem.classList.remove("show");
            updateitem.classList.remove("show");
            addCatatory.classList.remove("show");

        }


        function showAddItem() {
            additem.classList.add("show");
        }
        function showDeleteItem() {
            deleteitem.classList.add("show");
        }
        function showUpdateItem() {
            updateitem.classList.add("show");
        }
        function showAddCategory() {
            addCatatory.classList.add("show");
        }






    </script>
</body>

</html>